{"ast":null,"code":"import React from'react';import{Play,Pause,Download}from'lucide-react';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const MessageBubble=_ref=>{let{message}=_ref;const isUser=message.sender==='user';const[isPlaying,setIsPlaying]=React.useState(false);const[duration,setDuration]=React.useState(0);const[currentTime,setCurrentTime]=React.useState(0);const audioRef=React.useRef(null);const formatTime=date=>{return date.toLocaleTimeString([],{hour:'2-digit',minute:'2-digit'});};const formatDuration=seconds=>{const mins=Math.floor(seconds/60);const secs=Math.floor(seconds%60);return\"\".concat(mins,\":\").concat(secs.toString().padStart(2,'0'));};const handleAudioPlay=()=>{if(message.audioUrl&&audioRef.current){if(isPlaying){audioRef.current.pause();}else{audioRef.current.play();}setIsPlaying(!isPlaying);}};React.useEffect(()=>{const audio=audioRef.current;if(!audio)return;const handleLoadedMetadata=()=>{setDuration(audio.duration);};const handleTimeUpdate=()=>{setCurrentTime(audio.currentTime);};const handleEnded=()=>{setIsPlaying(false);setCurrentTime(0);};const handlePlay=()=>setIsPlaying(true);const handlePause=()=>setIsPlaying(false);audio.addEventListener('loadedmetadata',handleLoadedMetadata);audio.addEventListener('timeupdate',handleTimeUpdate);audio.addEventListener('ended',handleEnded);audio.addEventListener('play',handlePlay);audio.addEventListener('pause',handlePause);return()=>{audio.removeEventListener('loadedmetadata',handleLoadedMetadata);audio.removeEventListener('timeupdate',handleTimeUpdate);audio.removeEventListener('ended',handleEnded);audio.removeEventListener('play',handlePlay);audio.removeEventListener('pause',handlePause);};},[message.audioUrl]);return/*#__PURE__*/_jsx(\"div\",{className:\"flex \".concat(isUser?'justify-end':'justify-start',\" mb-2\"),children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-end space-x-2 max-w-xs lg:max-w-md \".concat(isUser?'flex-row-reverse space-x-reverse':''),children:[!isUser&&/*#__PURE__*/_jsx(\"div\",{className:\"w-8 h-8 bg-whatsapp-green rounded-full flex items-center justify-center flex-shrink-0\",children:/*#__PURE__*/_jsx(\"span\",{className:\"text-white text-sm font-semibold\",children:\"AI\"})}),/*#__PURE__*/_jsx(\"div\",{className:\"message-bubble \".concat(isUser?'message-out':'message-in',\" \").concat(isUser?'ml-12':'mr-12'),children:message.type==='text'?/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-sm leading-relaxed\",children:message.text}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-end mt-1 space-x-1 \".concat(isUser?'text-gray-500':'text-gray-600'),children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-xs\",children:formatTime(message.timestamp)}),isUser&&/*#__PURE__*/_jsxs(\"div\",{className:\"flex space-x-1\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-xs\",children:\"\\u2713\"}),/*#__PURE__*/_jsx(\"span\",{className:\"text-xs\",children:\"\\u2713\"})]})]})]}):/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-3\",children:[/*#__PURE__*/_jsx(\"audio\",{ref:audioRef,src:message.audioUrl,preload:\"metadata\"}),/*#__PURE__*/_jsx(\"button\",{onClick:handleAudioPlay,className:\"w-8 h-8 bg-whatsapp-green rounded-full flex items-center justify-center hover:bg-whatsapp-green-dark transition-colors\",children:isPlaying?/*#__PURE__*/_jsx(Pause,{className:\"w-4 h-4 text-white\"}):/*#__PURE__*/_jsx(Play,{className:\"w-4 h-4 text-white ml-0.5\"})}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex-1\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"w-32 h-2 bg-gray-300 rounded-full overflow-hidden\",children:/*#__PURE__*/_jsx(\"div\",{className:\"h-full bg-whatsapp-green rounded-full transition-all duration-100\",style:{width:duration>0?\"\".concat(currentTime/duration*100,\"%\"):'0%'}})}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between mt-1\",children:[/*#__PURE__*/_jsxs(\"span\",{className:\"text-xs text-gray-500\",children:[formatDuration(currentTime),\" / \",formatDuration(duration)]}),/*#__PURE__*/_jsx(\"button\",{className:\"text-gray-500 hover:text-gray-700\",onClick:()=>{if(message.audioUrl){const a=document.createElement('a');a.href=message.audioUrl;a.download='audio-message.wav';a.click();}},children:/*#__PURE__*/_jsx(Download,{className:\"w-3 h-3\"})})]})]})]})})]})});};export default MessageBubble;","map":{"version":3,"names":["React","Play","Pause","Download","jsx","_jsx","jsxs","_jsxs","MessageBubble","_ref","message","isUser","sender","isPlaying","setIsPlaying","useState","duration","setDuration","currentTime","setCurrentTime","audioRef","useRef","formatTime","date","toLocaleTimeString","hour","minute","formatDuration","seconds","mins","Math","floor","secs","concat","toString","padStart","handleAudioPlay","audioUrl","current","pause","play","useEffect","audio","handleLoadedMetadata","handleTimeUpdate","handleEnded","handlePlay","handlePause","addEventListener","removeEventListener","className","children","type","text","timestamp","ref","src","preload","onClick","style","width","a","document","createElement","href","download","click"],"sources":["C:/Users/Sona_M/OneDrive/Desktop/MediChatbot/src/components/MessageBubble.tsx"],"sourcesContent":["import React from 'react';\nimport { Play, Pause, Download } from 'lucide-react';\nimport { Message } from '../store/chatStore';\n\ninterface MessageBubbleProps {\n  message: Message;\n}\n\nconst MessageBubble: React.FC<MessageBubbleProps> = ({ message }) => {\n  const isUser = message.sender === 'user';\n  const [isPlaying, setIsPlaying] = React.useState(false);\n  const [duration, setDuration] = React.useState(0);\n  const [currentTime, setCurrentTime] = React.useState(0);\n  const audioRef = React.useRef<HTMLAudioElement>(null);\n\n  const formatTime = (date: Date) => {\n    return date.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });\n  };\n\n  const formatDuration = (seconds: number) => {\n    const mins = Math.floor(seconds / 60);\n    const secs = Math.floor(seconds % 60);\n    return `${mins}:${secs.toString().padStart(2, '0')}`;\n  };\n\n  const handleAudioPlay = () => {\n    if (message.audioUrl && audioRef.current) {\n      if (isPlaying) {\n        audioRef.current.pause();\n      } else {\n        audioRef.current.play();\n      }\n      setIsPlaying(!isPlaying);\n    }\n  };\n\n  React.useEffect(() => {\n    const audio = audioRef.current;\n    if (!audio) return;\n\n    const handleLoadedMetadata = () => {\n      setDuration(audio.duration);\n    };\n\n    const handleTimeUpdate = () => {\n      setCurrentTime(audio.currentTime);\n    };\n\n    const handleEnded = () => {\n      setIsPlaying(false);\n      setCurrentTime(0);\n    };\n\n    const handlePlay = () => setIsPlaying(true);\n    const handlePause = () => setIsPlaying(false);\n\n    audio.addEventListener('loadedmetadata', handleLoadedMetadata);\n    audio.addEventListener('timeupdate', handleTimeUpdate);\n    audio.addEventListener('ended', handleEnded);\n    audio.addEventListener('play', handlePlay);\n    audio.addEventListener('pause', handlePause);\n\n    return () => {\n      audio.removeEventListener('loadedmetadata', handleLoadedMetadata);\n      audio.removeEventListener('timeupdate', handleTimeUpdate);\n      audio.removeEventListener('ended', handleEnded);\n      audio.removeEventListener('play', handlePlay);\n      audio.removeEventListener('pause', handlePause);\n    };\n  }, [message.audioUrl]);\n\n  return (\n    <div className={`flex ${isUser ? 'justify-end' : 'justify-start'} mb-2`}>\n      <div className={`flex items-end space-x-2 max-w-xs lg:max-w-md ${isUser ? 'flex-row-reverse space-x-reverse' : ''}`}>\n        {/* Avatar */}\n        {!isUser && (\n          <div className=\"w-8 h-8 bg-whatsapp-green rounded-full flex items-center justify-center flex-shrink-0\">\n            <span className=\"text-white text-sm font-semibold\">AI</span>\n          </div>\n        )}\n        \n        {/* Message Content */}\n        <div className={`message-bubble ${isUser ? 'message-out' : 'message-in'} ${isUser ? 'ml-12' : 'mr-12'}`}>\n          {message.type === 'text' ? (\n            <div>\n              <p className=\"text-sm leading-relaxed\">{message.text}</p>\n              <div className={`flex items-center justify-end mt-1 space-x-1 ${isUser ? 'text-gray-500' : 'text-gray-600'}`}>\n                <span className=\"text-xs\">{formatTime(message.timestamp)}</span>\n                {isUser && (\n                  <div className=\"flex space-x-1\">\n                    <span className=\"text-xs\">✓</span>\n                    <span className=\"text-xs\">✓</span>\n                  </div>\n                )}\n              </div>\n            </div>\n          ) : (\n            <div className=\"flex items-center space-x-3\">\n              <audio ref={audioRef} src={message.audioUrl} preload=\"metadata\" />\n              <button\n                onClick={handleAudioPlay}\n                className=\"w-8 h-8 bg-whatsapp-green rounded-full flex items-center justify-center hover:bg-whatsapp-green-dark transition-colors\"\n              >\n                {isPlaying ? (\n                  <Pause className=\"w-4 h-4 text-white\" />\n                ) : (\n                  <Play className=\"w-4 h-4 text-white ml-0.5\" />\n                )}\n              </button>\n              <div className=\"flex-1\">\n                <div className=\"w-32 h-2 bg-gray-300 rounded-full overflow-hidden\">\n                  <div \n                    className=\"h-full bg-whatsapp-green rounded-full transition-all duration-100\"\n                    style={{ width: duration > 0 ? `${(currentTime / duration) * 100}%` : '0%' }}\n                  ></div>\n                </div>\n                <div className=\"flex items-center justify-between mt-1\">\n                  <span className=\"text-xs text-gray-500\">\n                    {formatDuration(currentTime)} / {formatDuration(duration)}\n                  </span>\n                  <button \n                    className=\"text-gray-500 hover:text-gray-700\"\n                    onClick={() => {\n                      if (message.audioUrl) {\n                        const a = document.createElement('a');\n                        a.href = message.audioUrl;\n                        a.download = 'audio-message.wav';\n                        a.click();\n                      }\n                    }}\n                  >\n                    <Download className=\"w-3 h-3\" />\n                  </button>\n                </div>\n              </div>\n            </div>\n          )}\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default MessageBubble;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}